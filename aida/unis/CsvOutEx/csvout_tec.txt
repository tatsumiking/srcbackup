
CSVOUTは、ベース時間からチェック時間まで退勤データをUNIS.MDBから取り出しCSVに出力するプログラムです。

CSVOUT最初の起動時には、ベース時間が0に設定されており、最初に適応ボタンを押した時点で、現在時刻からいちばん近いチェック時間を内部変数として設定して、時間チェックループにはいります、

現在時刻が設定されたチェック時間を超過した時点で、データベースから、ベース時間とチェック時間までの 退勤  データを現在の日付のCSVファイルとして出力します、

その後ベース時間をCSVOUT.ENVファイルに書き込み保存します。
その後次のチェック時間を設定し、時間チェックループ処理を行います。

今回システム時間を手動により設定した時点でCSVファイルが出力した原因ですが、通常時CSVファイルを出力後、ベース時間が設定され次のチェック時間をプログラム内部で設定された後に、日付を手動で変更したため、チェック時間を超過したためその現在設定された時刻をファイル名としたCSVが作成され、チェック 時間 をベース時間に設定しCSVOUT.ENVに書き出し次のチェック時間を内部で設定して通常の時間チェックループ処理に移行します。

　具体的には12/31 00:05がベース時間で設定されチェック時間が1/1 00:00に設定された状態で、日付を2/29 12:58に設定した場合、12/31 0:05から1/1/ 0:05までのデータが201902291258の日付の入ったCSVファイル名出力されます。
　次のベース時間が1/1 0:05となり次のチェック時間が3/1 0:05に設定され,3/1 0:05を超過した時点で1/1 0:05から3/1 0:05までのデータが201903010005の日付の入ったCSVファイルとして出力されます。


